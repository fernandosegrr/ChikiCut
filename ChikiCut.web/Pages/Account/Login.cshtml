@page
@model ChikiCut.web.Pages.Account.LoginModel
@{
    ViewData["Title"] = "Iniciar Sesión";
    Layout = "_LoginLayout";
}

<div class="login-container">
    <div class="login-card">
        <!-- Header corporativo -->
        <div class="login-header">
            <div class="brand-section">
                <div class="brand-logo">
                    <i class="bi bi-scissors brand-icon"></i>
                </div>
                <h1 class="brand-title">ChikiCut</h1>
                <p class="brand-subtitle">Sistema de Gestión de Peluquerías Infantiles</p>
            </div>
        </div>

        <!-- Formulario de login -->
        <div class="login-form-container">
            <form method="post" class="login-form">
                @if (!ViewData.ModelState.IsValid)
                {
                    <div asp-validation-summary="All" class="alert alert-danger" role="alert" style="display: block;"></div>
                }
                else
                {
                    <div asp-validation-summary="All" class="alert alert-danger" role="alert" style="display: none;"></div>
                }
                <div class="form-floating mb-4">
                    <input asp-for="Input.Email" type="email" class="form-control" id="emailInput" placeholder="usuario@chikicut.com" autofocus />
                    <label for="emailInput"><i class="bi bi-envelope me-2"></i>Correo Electrónico</label>
                    <span asp-validation-for="Input.Email" class="invalid-feedback"></span>
                </div>

                <div class="form-floating mb-4">
                    <input asp-for="Input.Password" type="password" class="form-control" id="passwordInput" placeholder="Contraseña" />
                    <label for="passwordInput"><i class="bi bi-lock me-2"></i>Contraseña</label>
                    <span asp-validation-for="Input.Password" class="invalid-feedback"></span>
                    <div class="password-toggle">
                        <i class="bi bi-eye" id="togglePassword"></i>
                    </div>
                </div>

                <div class="form-check mb-4">
                    <input asp-for="Input.RememberMe" class="form-check-input" type="checkbox" id="rememberCheck">
                    <label class="form-check-label" for="rememberCheck">
                        Mantener sesión iniciada
                    </label>
                </div>

                <button type="submit" class="btn btn-primary btn-login w-100 mb-4">
                    <i class="bi bi-box-arrow-in-right me-2"></i>Iniciar Sesión
                </button>

                <div class="login-help">
                    <p class="text-center">
                        <small class="text-muted">
                            ¿Problemas para acceder? 
                            <a href="#" class="link-help" data-bs-toggle="modal" data-bs-target="#helpModal">
                                Contacta al administrador
                            </a>
                        </small>
                    </p>
                </div>
            </form>
        </div>

        <!-- Footer del login -->
        <div class="login-footer">
            <div class="security-badge">
                <i class="bi bi-shield-check me-1"></i>
                <small>Conexión segura protegida</small>
            </div>
        </div>
    </div>

    <!-- Información adicional en pantallas grandes -->
    <div class="login-info d-none d-lg-block">
        <div class="info-card">
            <h3><i class="bi bi-stars me-2"></i>Bienvenido a ChikiCut</h3>
            <div class="feature-list">
                <div class="feature-item">
                    <i class="bi bi-check-circle-fill text-success me-2"></i>
                    <span>Gestión completa de empleados</span>
                </div>
                <div class="feature-item">
                    <i class="bi bi-check-circle-fill text-success me-2"></i>
                    <span>Control de sucursales</span>
                </div>
                <div class="feature-item">
                    <i class="bi bi-check-circle-fill text-success me-2"></i>
                    <span>Sistema de roles y permisos</span>
                </div>
                <div class="feature-item">
                    <i class="bi bi-check-circle-fill text-success me-2"></i>
                    <span>Reportes y estadísticas</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal de ayuda -->
<div class="modal fade" id="helpModal" tabindex="-1" aria-labelledby="helpModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="helpModalLabel">
                    <i class="bi bi-question-circle me-2"></i>¿Necesitas ayuda?
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Si tienes problemas para acceder a tu cuenta, contacta al administrador del sistema:</p>
                <ul>
                    <li><strong>Email:</strong> admin@chikicut.com</li>
                    <li><strong>Teléfono:</strong> (55) 1234-5678</li>
                    <li><strong>Horario:</strong> Lunes a Viernes 9:00 AM - 6:00 PM</li>
                </ul>
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>Nota:</strong> Por seguridad, no compartimos contraseñas por teléfono o email.
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Toggle para mostrar/ocultar contraseña
            const togglePassword = document.getElementById('togglePassword');
            const passwordInput = document.getElementById('passwordInput');
            
            if (togglePassword && passwordInput) {
                togglePassword.addEventListener('click', function() {
                    const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                    passwordInput.setAttribute('type', type);
                    
                    this.classList.toggle('bi-eye');
                    this.classList.toggle('bi-eye-slash');
                });
            }
            
            // Mostrar errores de validación si existen
            const errorContainer = document.querySelector('[asp-validation-summary]');
            if (errorContainer) {
                if (errorContainer.innerHTML.trim() !== '' || errorContainer.querySelector('li, ul')) {
                    errorContainer.style.display = 'block';
                }
            }
            
            // Focus mejorado en inputs
            const inputs = document.querySelectorAll('.form-floating input');
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.parentElement.classList.add('focused');
                });
                
                input.addEventListener('blur', function() {
                    if (!this.value) {
                        this.parentElement.classList.remove('focused');
                    }
                });
            });
        });
    </script>
}